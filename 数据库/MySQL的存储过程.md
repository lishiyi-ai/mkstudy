#### MySQL的数据存放在哪个文件？

**数据库目录**下有什么文件：
	**db.opt**：存储默认字符集和字符校验规则。
	**table.frm**：存储表结构。
	**table.ibd**：存储表的数据和索引。(表数据既可以在**共享存储空间文件**ibdata1,也可以放在**独立表空间文件**)

#### 表空间文件的结构式什么样的？

表空间由**段(segment)**，**区(extent)**，**页(page)**，**行(row)**组成。

**1.行**：记录都是按行存放的，每个记录根据不同的行格式，有不同的存储结构。

**2.页**：记录时按照行存储，但**InnoDB 的数据是按「页」为单位来读写的**，每页默认大小为16KB。

**3.区**：在表中**数据量大**的时候，为某个索引分配空间的时候就不再按照页为单位分配了，而是**按照区（extent）为单位分配**。每个区的大小为 1MB，对于 16KB 的页来说，**连续的 64 个页会被划为一个区，这样就使得链表中相邻的页的物理位置也相邻，就能使用顺序 I/O 了**。

**4.段**：表空间是由各个段（segment）组成的，段是由多个区（extent）组成的。段一般分为**数据段**、**索引段**和**回滚段**等。
	索引段：存放 B + 树的**非叶子节点**的区的集合；
	数据段：存放 B + 树的**叶子节点**的区的集合；
	回滚段：存放的是回滚数据的区的集合；

#### InnoDB行格式有哪些？

Redundant、Compact、Dynamic(默认模式)、Compressed

**Compact**：
	**变长字段**长度列表，**NULL值**列表，**记录头信息**，row_id，trx_id，roll_ptr，列1值，列n值。
	**变长列表**：存储变长字段**真实数据占用的字节数**。
	**NULL值列表**：采用字节的位表示是否为NULL，若位1则NULL，为0则不会NULL，从0位开始。对于NOT NULL 的表，没有NULL值列表。
	**头记录信息**：
		delete_mask：标记词条数据是否被删除。
		next_record：下一条记录的位置。
		record_type：当前记录的类型。
**记录真实数据**
	**row_id**：若有主键或唯一约束列，则没有该字段；否则有该字段。
	**trx_id**：事务id，占用6字节，是必须的。
	**roll_ptr**：记录了上一版本的指针，占用7字节，是必须的。

#### varchar(n) 中 n 最大取值为多少？65532

varchar(n) 字段类型的 n 代表的是最多存储的字符数量，并不是字节大小哦。
一行数据最多只能占用65535字节，除了大对象类型。
存储varchar(n)的数据时，分**三个部分存储**：
	真实数据，真实数据占用的字节数，NULL标识。

#### 行溢出后，MySQL是怎么处理的？

对于大对象类型可能一个页就存不了一条记录，则时候会发生行溢出，多的数据就会存到另外的[溢出页]中。

当发生行溢出时，在记录的真实数据处只会**保存该列的一部分数据**，而把剩余的数据放在「溢出页」中，然后**真实数据处用 20 字节存储指向溢出页的地址**，从而可以找到剩余数据所在的页。

**Dynamic**只存储20个字节的指针来指向溢出页。